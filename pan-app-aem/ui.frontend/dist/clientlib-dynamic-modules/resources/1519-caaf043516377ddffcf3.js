(self.webpackChunkwebapp_adobe_experience_ds=self.webpackChunkwebapp_adobe_experience_ds||[]).push([[1519,5749],{1519:function(e,t,a){"use strict";a.r(t);var n=a(5749);describe("Inner HTML Mock & Class Object testing",function(){beforeEach(function(){document.body.innerHTML='\n<section data-cmp-is="Nps-Relacional">\n    <div class="nps-relacional d-grid" data-js="nps-relacional-fluxo-principal">\n\n        <img class="nps-relacional__picture d-none d-lg-flex" loading="lazy" alt="#" width="1440" height="688" src="/content/dam/webapp--aem-institucional/blog_limite_pix_desktop.webp">\n\n        <div class="container nps-relacional__frame d-md-flex flex-column justify-content-center">\n            <div class="row justify-content-evenly">\n                <div class="col-12 col-md-6 col-lg-5 d-flex align-items-center p-0">\n                    <div class="nps-relacional__texts d-flex flex-column">\n                        <h2 class="typography-title-4 m-0">\n                            Sua opinião importa</h2>\n                        <h1 class="typography-big-text-2 m-0 d-flex">\n                            Queremos saber como foi sua experiência&nbsp;</h1>\n                        <p class="typography-body-1 m-0">Para nos ajudar, basta nos contar em apenas dois passos, como foi a sua experiência com seu último atendimento no Banco PAN.</p>\n                    </div>\n                </div>\n                <div class="col-12 col-md-5 p-0 d-flex justify-content-end">\n                    <div class="nps-relacional__form-container" id="form">\n                        <div class="nps-relacional__wrapper-form d-flex flex-column">\n                            <input type="hidden" data-js="nps-endpoint-input" value="https://ap-gateway-web-hml.bancopan.com.br/leads/campanhas/api/formulario/nps">\n                            <input type="hidden" data-js="nps-captcha-version" value="v3">\n                            <h2 class="typography-title-4 text-center">\n                                Numa escala de 0 a 10, o quanto você recomendaria o PAN a um amigo ou parente?\n                            </h2>\n                            <div class="nps-relacional__score">\n                                <ul class="nps-relacional__score-list">\n                                    <li class="nps-relacional__score-list-item">\n                                        <button type="button" class="nps-relacional__score-list-item-button typography-body-2" value="0">\n                                            0\n                                        </button>\n                                    </li>\n                                    <li class="nps-relacional__score-list-item">\n                                        <button type="button" class="nps-relacional__score-list-item-button typography-body-2" value="1">\n                                            1\n                                        </button>\n                                    </li>\n                                    <li class="nps-relacional__score-list-item">\n                                        <button type="button" class="nps-relacional__score-list-item-button typography-body-2" value="2">\n                                            2\n                                        </button>\n                                    </li>\n                                    <li class="nps-relacional__score-list-item">\n                                        <button type="button" class="nps-relacional__score-list-item-button typography-body-2" value="3">\n                                            3\n                                        </button>\n                                    </li>\n                                    <li class="nps-relacional__score-list-item">\n                                        <button type="button" class="nps-relacional__score-list-item-button typography-body-2" value="4">\n                                            4\n                                        </button>\n                                    </li>\n                                    <li class="nps-relacional__score-list-item">\n                                        <button type="button" class="nps-relacional__score-list-item-button typography-body-2" value="5">\n                                            5\n                                        </button>\n                                    </li>\n                                    <li class="nps-relacional__score-list-item">\n                                        <button type="button" class="nps-relacional__score-list-item-button typography-body-2" value="6">\n                                            6\n                                        </button>\n                                    </li>\n                                    <li class="nps-relacional__score-list-item">\n                                        <button type="button" class="nps-relacional__score-list-item-button typography-body-2" value="7">\n                                            7\n                                        </button>\n                                    </li>\n                                    <li class="nps-relacional__score-list-item">\n                                        <button type="button" class="nps-relacional__score-list-item-button typography-body-2" value="8">\n                                            8\n                                        </button>\n                                    </li>\n                                    <li class="nps-relacional__score-list-item">\n                                        <button type="button" class="nps-relacional__score-list-item-button typography-body-2" value="9">\n                                            9\n                                        </button>\n                                    </li>\n                                    <li class="nps-relacional__score-list-item">\n                                        <button type="button" class="nps-relacional__score-list-item-button typography-body-2" value="10">\n                                            10\n                                        </button>\n                                    </li>\n                                </ul>\n                            </div>\n                            <div class="nps-relacional__recomendation d-none d-lg-flex justify-content-lg-between">\n                                <span class="nps-relacional__recomendation-text">Não recomendaria</span>\n                                <span class="nps-relacional__recomendation-text">Recomendaria</span>\n                            </div>\n                            <h2 class="typography-body-2 text-space">\n                                Nos conte o motivo de sua nota:\n                            </h2>\n                            <div class="nps-relacional__text-area">\n                                <div class="col-12 nps-relacional__testimony">\n                                    <form class="nps-relacional__testimony-form" data-js="nps-relacional-form">\n                                        <mahoe-textarea data-js="nps-relacional-depoimento" placeholder="Queremos te ouvir..." class="hydrated">\n                                    \n                                <label class="mahoe-textarea"><span class="mahoe-textarea__label typography-small"></span><textarea placeholder="Queremos te ouvir..."></textarea></label></mahoe-textarea></form></div>\n                            </div>\n                            \n                                <input type="hidden" data-js="nps-captcha-siteKey" value="6LeIxAcTAAAAAJcZVRqyHh71UMIEGNQ_MXjiZKhI">\n                            \n                            \n                            <div class="nps-relacional__finish-button">\n                                <mahoe-button class="nps-relacional__navigation-button-submit hydrated" data-track="#" type="button" disabled="" data-js="nps-relacional-button-submit" size="md" variant="primary">\x3c!----\x3e<button type="button" disabled="" class="mahoe-button mahoe-button__primary"><span class="mahoe-button__container"><span class="mahoe-button__label">\n                                    hfghgfhfgc b\n                                </span></span></button></mahoe-button>\n                            </div>\n                        </div>\n                        <div class="nps-relacional__wrapper-success d-none flex-column">\n                            <h1 class="typography-title-1 title">Obrigado!</h1>\n                            <div class="typography-body-1">É muito bom saber que podemos contar com você! O seu feedback é muito importante para nós.</div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="nps-relacional nps-relacional--error d-none b-sizing" data-js="nps-relacional-fluxo-erro">\n        <div class="container">\n            <div class="row">\n                <div class="col-12 col-lg-5">\n                    <div class="nps-relacional__flag-error">\n                        <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n                            <path d="M19.9992 38.5725C30.2559 38.5725 38.5706 30.2578 38.5706 20.0011C38.5706 9.7444 30.2559 1.42969 19.9992 1.42969C9.74245 1.42969 1.42773 9.7444 1.42773 20.0011C1.42773 30.2578 9.74245 38.5725 19.9992 38.5725Z" stroke="#F3F4F9" stroke-width="2.8" stroke-linecap="round" stroke-linejoin="round"></path>\n                            <path d="M20 10V18.5714" stroke="#F3F4F9" stroke-width="2.8" stroke-linecap="round" stroke-linejoin="round"></path>\n                            <path d="M19.9989 28.572C20.7879 28.572 21.4275 27.9324 21.4275 27.1434C21.4275 26.3544 20.7879 25.7148 19.9989 25.7148C19.2099 25.7148 18.5703 26.3544 18.5703 27.1434C18.5703 27.9324 19.2099 28.572 19.9989 28.572Z" stroke="#F3F4F9" stroke-width="2.8" stroke-linecap="round" stroke-linejoin="round"></path>\n                        </svg>\n                    </div>\n                    <div class="nps-relacional__text-error d-none" data-js="nps-relacional-fluxo-erro-respondida">\n                        <h2 class="typography-big-text-2">\n                            Pesquisa já respondida ou ela não está mais\n                            disponível\n                        </h2>\n                    </div>\n                    <div class="nps-relacional__text-error d-none" data-js="nps-relacional-fluxo-erro-link-expirado">\n                        <h2 class="typography-big-text-2">\n                            O link para esta pesquisa está inválido ou expirado\n                        </h2>\n                    </div>\n                    <div class="nps-relacional__text-error d-none" data-js="nps-relacional-fluxo-erro-manutencao">\n                        <h2 class="typography-big-text-2">\n                            No momento não conseguimos abrir a página solicitada\n                        </h2>\n                        <p class="typography-large">\n                            Tente novamente mais tarde.\n                        </p>\n                    </div>\n                    <div class="nps-relacional__button-error d-flex">\n                        <mahoe-button size="md" variant="primary" title="Ir para o site do PAN!" href="https://www.bancopan.com.br/" class="hydrated">\x3c!----\x3e<button type="button" class="mahoe-button mahoe-button__primary"><span class="mahoe-button__container"><span class="mahoe-button__label">\n                            Ir para o site do PAN\n                        </span></span><div class="mahoe-ripple"></div></button></mahoe-button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</section>\n',jest.clearAllMocks(),jest.useFakeTimers()}),afterEach(function(){jest.useRealTimers()}),test("check if cpf parameter was stored locally",function(){var e=new n.default;e.cpfParam="01234567890",e.protocolParam="09876543210",e.storeParamsLocally();var t=localStorage.getItem("c");expect(t).toBe("01234567890")}),test("check if protocol parameter was stored locally",function(){var e=new n.default;e.cpfParam="01234567890",e.protocolParam="09876543210",e.storeParamsLocally();var t=localStorage.getItem("p");expect(t).toBe("09876543210")}),test("validate recaptcha callback",function(){var e=new n.default;e.recaptchaCallbackNpsRelacional(""),e.recaptchaResponse="",e.isCaptchaValid=!0,expect(e.isCaptchaValid).toBe(!0)}),test("handle success",function(){var e=new n.default;e.handleSuccess();var t=e.$wrapperForm.classList.contains("d-none")&&e.$wrapperSuccess.classList.contains("d-flex");expect(t).toBe(!0)}),test("handle error",function(){var e=new n.default;e.handleError();var t=e.$wrapperMainStream.classList.contains("d-none")&&!e.$wrapperErroFlow.classList.contains("d-none")&&!e.$flowErrorResquest.classList.contains("d-none");expect(t).toBe(!0)})})},5749:function(e,t,a){"use strict";a.r(t);a(7582);var n=a(6590),o=function(e,t,a,n){return new(a||(a=Promise))(function(o,s){function r(e){try{l(n.next(e))}catch(e){s(e)}}function i(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a(function(e){e(t)})).then(r,i)}l((n=n.apply(e,t||[])).next())})},s=function(e,t){var a,n,o,s,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(i){return function(l){return function(i){if(a)throw new TypeError("Generator is already executing.");for(;s&&(s=0,i[0]&&(r=0)),r;)try{if(a=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,n=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){r=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){r.label=i[1];break}if(6===i[0]&&r.label<o[1]){r.label=o[1],o=i;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(i);break}o[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],n=0}finally{a=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}},r=function(){function e(){var e=this;this.recaptchaResponse="",this.$npsRelacionalEndPoint=document.querySelector("[data-js=nps-endpoint-input]"),this.urlParamsCpf=new URLSearchParams(window.location.search),this.urlParamsProtocol=new URLSearchParams(window.location.search),this.origemPesquisa=window.location.origin+window.location.pathname,this.$npsTestimonyValue=document.querySelector("[data-js=nps-relacional-depoimento]"),this.$wrapperMainStream=document.querySelector("[data-js=nps-relacional-fluxo-principal]"),this.$wrapperForm=document.querySelector(".nps-relacional__wrapper-form"),this.$wrapperSuccess=document.querySelector(".nps-relacional__wrapper-success"),this.$wrapperErroFlow=document.querySelector("[data-js=nps-relacional-fluxo-erro]"),this.$flowErrorResquest=document.querySelector("[data-js=nps-relacional-fluxo-erro-manutencao]"),this.$flowAlreadyAnswered=document.querySelector("[data-js=nps-relacional-fluxo-erro-respondida]"),this.$expiredLinkFlow=document.querySelector("[data-js=nps-relacional-fluxo-erro-link-expirado]"),this.$finishQuizButton=document.querySelector("[data-js=nps-relacional-button-submit]"),this.$npsScoreButtons=document.querySelectorAll(".nps-relacional__score-list > .nps-relacional__score-list-item > button"),this.$formLeadVersion=document.querySelector("[data-js=nps-captcha-version]"),this.$formLeadSiteKey=document.querySelector("[data-js=nps-captcha-siteKey]"),this.recaptchaCallbackNpsRelacional=function(t){e.recaptchaResponse=t,e.isCaptchaValid=!0,e.validateCaptcha()},this.choiceScore=function(){e.$npsScoreButtons.forEach(function(t){t.addEventListener("click",function(){e.$npsScoreButtons.forEach(function(e){e.classList.remove("active")}),e.$npsScore=t.value,t.classList.add("active"),e.validateCaptcha()})})},this.getTestimonyValue=function(){e.$npsTestimony=e.$npsTestimonyValue.querySelector("textarea").value},this.validateCaptcha=function(){e.isCaptchaValid&&(e.$finishQuizButton.disabled=!1)},this.handleSubmit=function(){e.$finishQuizButton.querySelector("button").innerText="Enviando...",e.sendFormData()},setTimeout(function(){e.getCaptchaToken(),e.initFormEvent()},1e3);var t=this.getUrlParams(),a=t.cpfParam,n=t.protocolParam;if(!a||!n)return this.$wrapperMainStream.classList.remove("d-grid"),this.$wrapperMainStream.classList.add("d-none"),this.$wrapperErroFlow.classList.remove("d-none"),this.$wrapperErroFlow.classList.add("d-flex"),void this.$expiredLinkFlow.classList.remove("d-none");this.cpfParam=a,this.protocolParam=n,this.protocolParam===localStorage.getItem("p")?(this.$wrapperMainStream.classList.remove("d-grid"),this.$wrapperMainStream.classList.add("d-none"),this.$wrapperErroFlow.classList.remove("d-none"),this.$wrapperErroFlow.classList.add("d-flex"),this.$flowAlreadyAnswered.classList.remove("d-none")):(this.protocolParam=localStorage.getItem("p"),this.protocolParam=n,this.$wrapperErroFlow.classList.add("d-none"),this.$wrapperMainStream.classList.remove("d-none"),this.$wrapperMainStream.classList.add("d-grid"))}return e.prototype.getCaptchaToken=function(){var e;return o(this,void 0,void 0,function(){var t;return s(this,function(a){switch(a.label){case 0:return[4,(0,n.Hh)(null===(e=this.$formLeadSiteKey)||void 0===e?void 0:e.value,{useEnterprise:!0})];case 1:return[4,a.sent().execute("SIGNUP")];case 2:return t=a.sent(),this.recaptchaResponse=t,t&&(this.isCaptchaValid=!0),[2]}})})},e.prototype.initFormEvent=function(){var e=this;this.$finishQuizButton.addEventListener("click",function(t){t.preventDefault(),e.handleSubmit()}),this.$npsTestimonyValue.querySelector("textarea").addEventListener("blur",function(){e.getTestimonyValue()}),this.choiceScore()},e.prototype.getUrlParams=function(){var e=new URLSearchParams(window.location.search);return{cpfParam:e.get("c"),protocolParam:e.get("p")}},e.prototype.storeParamsLocally=function(){this.cpfParam&&this.protocolParam&&(localStorage.setItem("c",this.cpfParam),localStorage.setItem("p",this.protocolParam))},e.prototype.sendFormData=function(){var e,t=this,a=this.$npsRelacionalEndPoint.value,n={CPF:this.urlParamsCpf.get("c"),COMENTARIO:this.$npsTestimony,NOTA:this.$npsScore,SOLIC_RESOLVIDA:!1,PROTOCOLO:this.urlParamsProtocol.get("p"),ORIGEM:this.origemPesquisa},o={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json","Authorization-Captcha":this.recaptchaResponse,SiteKey:null===(e=this.$formLeadSiteKey)||void 0===e?void 0:e.value},body:JSON.stringify(n)};fetch(a,o).then(function(e){e.status>=200&&e.status<400?t.handleSuccess():t.handleError()}).catch(function(){t.handleError()})},e.prototype.handleSuccess=function(){this.$wrapperForm.classList.add("d-none"),this.$wrapperSuccess.classList.remove("d-none"),this.$wrapperSuccess.classList.add("d-flex"),this.storeParamsLocally()},e.prototype.handleError=function(){this.$wrapperMainStream.classList.add("d-none"),this.$wrapperErroFlow.classList.remove("d-none"),this.$flowErrorResquest.classList.remove("d-none")},e}();t.default=r},7558:function(e,t,a){"use strict";a.r(t)},7582:function(e,t,a){var n=a(7558);"string"==typeof n&&(n=[[e.id,n,""]]);a(1023)(n,{});n.locals&&(e.exports=n.locals)}}]);